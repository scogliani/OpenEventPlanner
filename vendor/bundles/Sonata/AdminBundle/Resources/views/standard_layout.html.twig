{#

This file is part of the Sonata package.

(c) Thomas Rabaix <thomas.rabaix@sonata-project.org>

For the full copyright and license information, please view the LICENSE
file that was distributed with this source code.

#}
{% set _preview      = block('preview') %}
{% set _form         = block('form') %}
{% set _show         = block('show') %}
{% set _list_table   = block('list_table') %}
{% set _list_filters = block('list_filters') %}
{% set _side_menu    = block('side_menu') %}
{% set _content      = block('content') %}
{% set _title        = block('title') %}
{% set _breadcrumb   = block('breadcrumb') %}
<!DOCTYPE html>
<html class="no-js">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

        {% block stylesheets %}
            <!-- jQuery code -->
            <link rel="stylesheet" href="{{ asset('bundles/sonatajquery/themes/flick/jquery-ui-1.8.16.custom.css') }}" type="text/css" media="all" />
			<link rel="stylesheet" href="{{ asset('bundles/sonataadmin/bootstrap/bootstrap.min.css') }}" type="text/css" media="all" >
			
            <!-- base application asset -->
            <link rel="stylesheet" href="{{ asset('bundles/sonataadmin/css/layout.css') }}" type="text/css" media="all">
            <link rel="stylesheet" href="{{ asset('bundles/sonataadmin/css/colors.css') }}" type="text/css" media="all">
			<style>
				#ui-datepicker-div{
					width:300px;
				}
			</style>
        {% endblock %}

        {% block javascripts %}
		
            <script src="{{ asset('bundles/sonatajquery/jquery-1.7.1.js') }}" type="text/javascript"></script>
			
            <script src="{{ asset('bundles/sonataadmin/bootstrap/js/bootstrap-tabs.js') }}" type="text/javascript"></script>
            <script src="{{ asset('bundles/sonataadmin/bootstrap/js/bootstrap-alerts.js') }}" type="text/javascript"></script>
            <script src="{{ asset('bundles/sonataadmin/bootstrap/js/bootstrap-modal.js') }}" type="text/javascript"></script>
            <script src="{{ asset('bundles/sonataadmin/bootstrap/js/bootstrap-twipsy.js') }}" type="text/javascript"></script>
            <script src="{{ asset('bundles/sonataadmin/bootstrap/js/bootstrap-popover.js') }}" type="text/javascript"></script>
            <script src="{{ asset('bundles/sonataadmin/bootstrap/js/bootstrap-scrollspy.js') }}" type="text/javascript"></script>
            <script src="{{ asset('bundles/sonataadmin/bootstrap/js/bootstrap-dropdown.js') }}" type="text/javascript"></script>

            <script src="{{ asset('bundles/sonataadmin/qtip/jquery.qtip-1.0.0-rc3.min.js') }}" type="text/javascript"></script>
            <script src="{{ asset('bundles/sonataadmin/jquery/jquery.form.js') }}" type="text/javascript"></script>
            <script src="{{ asset('bundles/sonataadmin/base.js') }}" type="text/javascript"></script>
			
			<script src="{{ asset('bundles/sonatajquery/jquery-ui-1.8.17.js') }}" type="text/javascript"></script>
            <script src="{{ asset('bundles/sonatajquery/jquery-ui-i18n.js') }}" type="text/javascript"></script>
			<script src="http://trentrichardson.com/examples/timepicker/js/jquery-ui-timepicker-addon.js" type="text/javascript"></script>
			
			<style>
				.ui-timepicker-div .ui-widget-header { margin-bottom: 0; }
				.ui-timepicker-div dl { text-align: left; }
				.ui-timepicker-div dl dt { height: 25px; margin-bottom: -25px; }
				.ui-timepicker-div dl dd { margin: 0 10px 10px 65px; }
				.ui-timepicker-div td { font-size: 90%; }
				.ui-tpicker-grid-label { background: none; border: none; margin: 0; padding: 0; }
			</style>
			
			<script type="text/javascript">
			
			$(function() {			
									
				$.datepicker.setDefaults($.datepicker.regional['']);
				
				$('form input.dateReport').datetimepicker({
					showOn: "button",
					buttonImage: "{{ asset('bundles/doodleplusadmin/images/calendar.gif') }}",
					buttonImageOnly: true,
					hourGrid: 4,
					minuteGrid: 15,
					minDate: new Date
				}).attr("readonly","readonly");
				
				$('form input.datetimer1Begin, form input.datetimer2Begin').datetimepicker({
					showOn: "button",
					buttonImageOnly: true,
					hourGrid: 4,
					minuteGrid: 15,
					minDate: new Date
				}).attr("readonly","readonly");
				
				$('form input.datetimeBegin').datetimepicker({
					showOn: "button",
					buttonImage: "{{ asset('bundles/doodleplusadmin/images/calendar.gif') }}",
					buttonImageOnly: true,
					hourGrid: 4,
					minuteGrid: 15,
					minDate: new Date,
					onClose: function(dateText, inst) {
						var endDateTextBox = $('form input.datetimeEnd');
						if (endDateTextBox.val() != '') {
							var testStartDate = new Date(dateText);
							var testEndDate = new Date(endDateTextBox.val());
							if (testStartDate > testEndDate)
								endDateTextBox.val(dateText);
						}
					},
					onSelect: function (selectedDateTime){
						var start = $(this).datetimepicker('getDate');
						// $('form input.datetimer1Begin, form input.datetimer2Begin').datetimepicker('option', 'minDate', new Date(start.getTime()));
						$('form input.datetimeEnd').datetimepicker('option', 'minDate', new Date(start.getTime()));
					}
				}).attr("readonly","readonly");
				
				$('form input.datetimeEnd').datetimepicker({
					showOn: "button",
					buttonImage: "{{ asset('bundles/doodleplusadmin/images/calendar.gif') }}",
					buttonImageOnly: true,
					hourGrid: 4,
					minuteGrid: 15,
					minDate: new Date,
					onClose: function(dateText, inst) {
						var startDateTextBox = $('form input.datetimeBegin');
						if (startDateTextBox.val() != '') {
							var testStartDate = new Date(startDateTextBox.val());
							var testEndDate = new Date(dateText);
							if (testStartDate > testEndDate)
								startDateTextBox.val(dateText);
						}
						else {
							startDateTextBox.val(dateText);
						}
					},
					onSelect: function (selectedDateTime){
						var end = $(this).datetimepicker('getDate');
						$('form input.datetimeBegin').datetimepicker('option', 'maxDate', new Date(end.getTime()) );
					}
				}).attr("readonly","readonly");
				
				function tooglePrice(jq) {
					if (jq.is(':checked')) {
						if ($("input.price").val() == '') {
							$("input.price").val('0.00');
						}
						
						$("input.price").removeAttr("disabled");
					} else {
						$("input.price").val('');
						$("input.price").attr("disabled", "disabled");
					}
				}
				
				function toogleResend(jq) {
					if (jq.is(':checked')) {
						$("input.datetimer1Begin, input.datetimer2Begin").datetimepicker('option', 'buttonImage', "{{ asset('bundles/doodleplusadmin/images/calendar.gif') }}");
					} else {
						$("input.datetimer1Begin, input.datetimer2Begin").datetimepicker('option', 'buttonImage', "{{ asset('bundles/doodleplusadmin/images/empty.gif') }}");
						$("input.datetimer1Begin, input.datetimer2Begin").datetimepicker('option', 'minDate', new Date);
						$("input.datetimer1Begin, input.datetimer2Begin").val('');
						$("input.datetimer1Begin, input.datetimer2Begin").datetimepicker('option', 'setDate', null);
					}
				}
				
				function toogleGuest(jq) {
					if (jq.is(':checked')) {
						$(".withSo input").removeAttr("disabled");
					} else {
						$(".withSo input:radio").val(['0']);
						$(".withSo input").attr("disabled", "disabled");
					}
				}
				
				function toogleExtern(jq) {
					if (jq.is(':checked')) {
						$(".titleExtern, .contentExtern").removeAttr("disabled");
					} else {
						$(".titleExtern, .contentExtern").val('');
						$(".titleExtern, .contentExtern").attr("disabled", "disabled");
					}
				}
				
				$(window).load(function() {
					toogleGuest($(".hasGuests"));
					toogleResend($(".hasResend"));
					tooglePrice($(".hasPrice"));
					toogleExtern($(".hasExtern"));
				});
			
				$(".hasResend").click(function() {
					toogleResend($(this));
				});
			
				$(".hasPrice").click(function() {
					tooglePrice($(this));
				});
				
				$(".hasGuests").click(function() {
					toogleGuest($(this));
				});
				
				$(".hasExtern").click(function() {
					toogleExtern($(this));
				});
				
			});
			</script>
			
        {% endblock %}

        <title>
            {% trans from 'SonataAdminBundle' %}Admin{% endtrans %}

            {% if _title is not empty %}
                {{ _title|raw }}
            {% else %}
                {% if action is defined %}
                    -
                    {% for label, uri in admin.breadcrumbs(action) %}
                        {% if not loop.first  %}
                            &gt;
                        {% endif %}
                        {{ label }}
                    {% endfor %}
                {% endif %}
            {% endif%}
        </title>
    </head>
    <body class="sonata-bc {% if _side_menu is empty %}sonata-ba-no-side-menu{% endif %}">
        {# initialize block value #}

        <div class="topbar" data-dropdown="dropdown" >
            <div class="topbar">
                <div class="topbar-inner">
                    <div class="container-fluid">
                        {% if admin_pool is defined %}
                            {% block logo %}
                                <a href="{{ url('sonata_admin_dashboard') }}" class="brand">
                                    {# <img src="{{ asset(admin_pool.titlelogo) }}"  alt="{{ admin_pool.title }}" /> #}
                                    {{ admin_pool.title }}
                                </a>
                            {% endblock %}
                            {% if app.user %}
                                <ul class="nav">
                                    {% for group in admin_pool.dashboardgroups %}
                                        <li class="dropdown">
                                            <a href="#" class="dropdown-toggle">{{ group.label|trans({}, 'SonataAdminBundle') }}</a>
                                            <ul class="dropdown-menu">
                                                {% for admin in group.items %}
                                                    <li><a href="{{ admin.generateUrl('list')}}">{{ admin.label|trans({}, admin.translationdomain) }}</a></li>
                                                {% endfor %}
                                            </ul>
                                        </li>
                                    {% endfor %}
                                </ul>
                            {% endif %}

                            <p class="pull-right">{% include admin_pool.getTemplate('user_block') %}</p>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>

        <div class="container-fluid">
            {% if _breadcrumb is not empty or action is defined %}
                <ul class="breadcrumb">
                    {% if _breadcrumb is empty %}
                        {% if action is defined %}
                            {% for label, uri in admin.breadcrumbs(action) %}
                                {% if not loop.last  %}
                                    <li><a href="{{ uri }}">{{ label }}</a><span class="divider">/</span></li>
                                {% else %}
                                    <li class="active">{{ label }}</li>
                                {% endif %}
                            {% endfor %}
                        {% endif %}
                    {% else %}
                        {{ _breadcrumb|raw }}
                    {% endif %}
                </ul>
            {% endif %}

            {% block notice %}
                {% for notice_level in ['success','error','info', 'warning'] %}
                    {% set session_var = 'sonata_flash_' ~ notice_level %}
                    {% if app.session.hasFlash(session_var) %}
                        <div class="alert-message {{ notice_level }}">
                            {{ app.session.flash(session_var) | trans([],'SonataAdminBundle') }}
                            {#<a class="close" href="#">×</a>#}
                        </div>
                    {% endif %}
                {% endfor %}
            {% endblock %}

            <div style="float: right">
                {%block actions %}{% endblock %}
            </div>

            {% if _title is not empty or action is defined %}
                <div class="page-header">
                    <h1>
                        {% if _title is not empty %}
                            {{ _title|raw }}
                        {% elseif action is defined %}
                            {% for label, uri in admin.breadcrumbs(action) %}
                                {% if loop.last  %}
                                    {{ label }}
                                {% endif %}
                            {% endfor %}
                        {% endif%}
                    </h1>
                </div>
            {% endif%}

            {% if _side_menu is not empty %}
                <div class="sidebar">
                    <div class="well sonata-ba-side-menu">{{ _side_menu|raw }}</div>
                </div>
            {% endif %}

            <div class="content">

                {% if _preview is not empty %}
                    <div class="sonata-ba-preview">{{ _preview|raw }}</div>
                {% endif %}


                {% if _content is not empty %}
                    <div class="sonata-ba-content">{{ _content|raw }}</div>
                {% endif %}

                {% if _show is not empty %}
                    <div class="sonata-ba-show">{{ _show|raw }}</div>
                {% endif %}

                {% if _form is not empty %}
                    <div class="sonata-ba-form">{{ _form|raw }}</div>
                {% endif %}

                {% if _list_table is not empty or _list_filters is not empty %}
                    <div class="sonata-ba-filter">
                        {{ _list_filters|raw }}
                    </div>
                    <div class="sonata-ba-list">
                        {{ _list_table|raw }}
                    </div>
                {% endif %}
{#
                {% block footer %}
                    <div class="pull-right clearfix">
                        <span class="label"><a href="http://sonata-project.org" rel="noreferrer" style="text-decoration: none; color: black">Sonata Project</a></span>
                    </div>
                {% endblock %}
#}
            </div>
        </div>
    </body>
</html>

